

// Obtén la referencia al contenedor de la tabla
var contenedorTabla = document.querySelector(".existence-table");

// Itera sobre la base de datos de libros y crea elementos para cada libro
baseDeDatosLibros.libros.forEach(libro => {
  // Busca las existencias correspondientes a este libro
  var existencias = baseDeDatosExistencias.existencias.filter(e => e.barcode === libro.barcode);

  // Crea un nuevo elemento de div para representar el libro usando template literals
  existencias.forEach(existencia => {
    // Ajusta el precio según el tipo de producto
    var precio = existencia.tipo === "outlet" ? "$800.00" : libro.price;

    contenedorTabla.innerHTML += `
      <div class="storage-item">
        <div class="stg-item-prop item-list-option">${libro.id}</div>
        <div class="stg-item-prop item-name">${libro.titulo}</div>
        <div class="stg-item-prop item-ed">${libro.ed}</div>
        <div class="stg-item-prop item-barcode">${libro.barcode}</div>
        <div class="stg-item-prop item-spec">${libro.spec}</div>
        <div class="stg-item-prop item-providor">${libro.providor}</div>
        <div class="stg-item-prop item-price">${precio}</div>
        <div class="stg-item-prop last-item-inserc">${libro.lastInserc}</div>
        <div class="stg-item-prop item-init-cant">${libro.initCant}</div>
        <div class="stg-item-prop item-current-cant">${existencia.cantidad > 0 ? existencia.cantidad : 'Agotado'}</div>
      </div>
    `;
  });
});
</script>



























<!-- Ejemplo de la estructura de divs -->
<div class="existence-table">
</div>

<script>
// Supongamos que tienes tu base de datos JSON de libros
var baseDeDatosLibros = {
  "libros": [
    {
      "id": 1,
      "titulo": "Dinosaurios y Vida Prehistórica",
      "ed": "DK",
      "barcode": "45346685646464",
      "spec": "Libro, Línea",
      "providor": "Hugo",
      "price": "$1150.00",
      "lastInserc": "27/12/24 2:30pm",
      "initCant": 4
    },
    // Puedes agregar más libros aquí según sea necesario
  ]
};

// Supongamos que tienes tu base de datos JSON de existencias
var baseDeDatosExistencias = {
  "existencias": [
    {
      "barcode": "45346685646464",
      "tipo": "linea",
      "cantidad": 10
    },
    {
      "barcode": "45346685646464",
      "tipo": "outlet",
      "cantidad": 5
    },
    // Puedes agregar más entradas aquí según sea necesario
  ]
};

// Nuevo libro a agregar
var nuevoLibro = {
  "name": "Nombre del nuevo libro",
  "editorial": "DK",
  "barcode": "NuevoBarcode", // Reemplaza con el nuevo código de barras
  "Type": "libro",
  "kind": "línea",
  "providor": "Hugo",
  "price": 1150,
  "año": 2017,
  "autor": "Kresley Donney",
};

// Agregar el nuevo libro a la base de datos de libros
baseDeDatosLibros.libros.push({
  "id": baseDeDatosLibros.libros.length + 1,
  "titulo": nuevoLibro.name,
  "ed": nuevoLibro.editorial,
  "barcode": nuevoLibro.barcode,
  "spec": `${nuevoLibro.Type}, ${nuevoLibro.kind}`,
  "providor": nuevoLibro.providor,
  "price": `$${nuevoLibro.price.toFixed(2)}`,
  "lastInserc": obtenerFechaActual(),
  "initCant": 0, // Inicializar con 0, ya que aún no hay existencias
});

// Agregar las nuevas existencias del libro
baseDeDatosExistencias.existencias.push(
  {
    "barcode": nuevoLibro.barcode,
    "tipo": "linea",
    "cantidad": 0
  },
  // Puedes agregar más entradas según sea necesario
);

// Obtén la referencia al contenedor de la tabla
var contenedorTabla = document.querySelector(".existence-table");

// Itera sobre la base de datos de libros y crea elementos para cada libro
baseDeDatosLibros.libros.forEach(libro => {
  // Busca las existencias correspondientes a este libro
  var existencias = baseDeDatosExistencias.existencias.filter(e => e.barcode === libro.barcode);

  // Crea un nuevo elemento de div para representar el libro usando template literals
  existencias.forEach(existencia => {
    // Ajusta el precio según el tipo de producto
    var precio = existencia.tipo === "outlet" ? "$800.00" : libro.price;

    contenedorTabla.innerHTML += `
      <div class="storage-item">
        <div class="stg-item-prop item-list-option">${libro.id}</div>
        <div class="stg-item-prop item-name">${libro.titulo}</div>
        <div class="stg-item-prop item-ed">${libro.ed}</div>
        <div class="stg-item-prop item-barcode">${libro.barcode}</div>
        <div class="stg-item-prop item-spec">${libro.spec}</div>
        <div class="stg-item-prop item-providor">${libro.providor}</div>
        <div class="stg-item-prop item-price">${precio}</div>
        <div class="stg-item-prop last-item-inserc">${libro.lastInserc}</div>
        <div class="stg-item-prop item-init-cant">${libro.initCant}</div>
        <div class="stg-item-prop item-current-cant">${existencia.cantidad > 0 ? existencia.cantidad : 'Agotado'}</div>
      </div>
    `;
  });
});

// Función para obtener la fecha actual en el formato deseado
function obtenerFechaActual() {
  var fecha = new Date();
  var dia = fecha.getDate();
  var mes = fecha.getMonth() + 1;
  var año = fecha.getFullYear();
  var horas = fecha.getHours();
  var minutos = fecha.getMinutes();

  // Agregar ceros al inicio si es necesario
  dia = dia < 10 ? `0${dia}` : dia;
  mes = mes < 10 ? `0${mes}` : mes;
  horas = horas < 10 ? `0${horas}` : horas;
  minutos = minutos < 10 ? `0${minutos}` : minutos;

  return `${dia}/${mes}/${año} ${horas}:${minutos}`;
}
</script>
